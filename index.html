<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website with Login and Chatroom</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Chatroom App</h1>
        <div id="user-display">Welcome, Guest</div>
    </header>
    <main>
        <section id="auth-section">
            <h2>Sign Up / Login</h2>
            <div id="auth-forms">
                <div id="signup-form">
                    <h3>Sign Up</h3>
                    <input type="text" id="signup-username" placeholder="Username">
                    <input type="password" id="signup-password" placeholder="Password">
                    <button onclick="signUp()">Sign Up</button>
                </div>
                <div id="login-form">
                    <h3>Login</h3>
                    <input type="text" id="login-username" placeholder="Username">
                    <input type="password" id="login-password" placeholder="Password">
                    <button onclick="login()">Login</button>
                </div>
            </div>
        </section>
        <section id="chatroom-section" style="display: none;">
            <h2>Chatroom</h2>
            <div id="chat-display"></div>
            <input type="text" id="chat-input" placeholder="Type your message...">
            <button onclick="sendMessage()">Send</button>
        </section>
        <section id="moderation-panel" style="display: none;">
            <h2>Moderation Panel</h2>
            <div id="user-list"></div>
        </section>
        <section id="ban-screen" style="display: none;">
            <h2>You Are Banned</h2>
            <p>Your account has been banned. Please contact support.</p>
        </section>
    </main>

    <script>
        // Initialize the system with a premade owner account
        if (!localStorage.getItem('users')) {
            localStorage.setItem('users', JSON.stringify({ owner: { password: 'ownerpass', balance: 0, banned: false } }));
        }

        function signUp() {
            const username = document.getElementById('signup-username').value;
            const password = document.getElementById('signup-password').value;

            if (!username || !password) {
                alert('Please fill in both fields.');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users'));

            if (users[username]) {
                alert('Username already exists.');
                return;
            }

            users[username] = { password: password, balance: 0, banned: false };
            localStorage.setItem('users', JSON.stringify(users));
            alert('Sign up successful!');
        }

        function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            if (!username || !password) {
                alert('Please fill in both fields.');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users'));
            const user = users[username];

            if (!user || user.password !== password) {
                alert('Invalid username or password.');
                return;
            }

            if (user.banned) {
                document.getElementById('auth-section').style.display = 'none';
                document.getElementById('ban-screen').style.display = 'block';
                return;
            }

            localStorage.setItem('currentUser', username);
            document.getElementById('user-display').textContent = `Welcome, ${username}`;
            document.getElementById('auth-section').style.display = 'none';

            if (username === 'owner') {
                document.getElementById('moderation-panel').style.display = 'block';
                displayUsers();
            } else {
                document.getElementById('chatroom-section').style.display = 'block';
            }
        }

        function sendMessage() {
            const currentUser = localStorage.getItem('currentUser');
            const messageInput = document.getElementById('chat-input');
            const chatDisplay = document.getElementById('chat-display');

            if (!currentUser) {
                alert('You must be logged in to send messages.');
                return;
            }

            const message = messageInput.value;

            if (!message) {
                alert('Message cannot be empty.');
                return;
            }

            const messages = JSON.parse(localStorage.getItem('messages')) || [];

            messages.push({ user: currentUser, text: message });
            localStorage.setItem('messages', JSON.stringify(messages));

            displayMessages();
            messageInput.value = '';
        }

        function displayMessages() {
            const messages = JSON.parse(localStorage.getItem('messages')) || [];
            const chatDisplay = document.getElementById('chat-display');

            chatDisplay.innerHTML = '';
            messages.forEach(msg => {
                const messageElement = document.createElement('div');
                messageElement.textContent = `${msg.user}: ${msg.text}`;
                chatDisplay.appendChild(messageElement);
            });
        }

        function displayUsers() {
            const users = JSON.parse(localStorage.getItem('users'));
            const userList = document.getElementById('user-list');

            userList.innerHTML = '';
            Object.keys(users).forEach(username => {
                const user = users[username];
                const userElement = document.createElement('div');

                userElement.innerHTML = `
                    <strong>${username}</strong> - Balance: ${user.balance} - Banned: ${user.banned}
                    <button onclick="addCurrency('${username}')">Add Currency</button>
                    <button onclick="banUser('${username}')">Ban</button>
                    <button onclick="unbanUser('${username}')">Unban</button>
                `;
                userList.appendChild(userElement);
            });
        }

        function addCurrency(username) {
            const amount = prompt('Enter amount to add:');
            const users = JSON.parse(localStorage.getItem('users'));

            if (!amount || isNaN(amount)) {
                alert('Invalid amount.');
                return;
            }

            users[username].balance += parseInt(amount);
            localStorage.setItem('users', JSON.stringify(users));
            displayUsers();
        }

        function banUser(username) {
            const users = JSON.parse(localStorage.getItem('users'));
            users[username].banned = true;
            localStorage.setItem('users', JSON.stringify(users));
            displayUsers();
        }

        function unbanUser(username) {
            const users = JSON.parse(localStorage.getItem('users'));
            users[username].banned = false;
            localStorage.setItem('users', JSON.stringify(users));
            displayUsers();
        }

        if (localStorage.getItem('currentUser')) {
            const currentUser = localStorage.getItem('currentUser');
            const users = JSON.parse(localStorage.getItem('users'));

            if (users[currentUser].banned) {
                document.getElementById('auth-section').style.display = 'none';
                document.getElementById('ban-screen').style.display = 'block';
            } else {
                document.getElementById('auth-section').style.display = 'none';
                if (currentUser === 'owner') {
                    document.getElementById('moderation-panel').style.display = 'block';
                    displayUsers();
                } else {
                    document.getElementById('chatroom-section').style.display = 'block';
                    document.getElementById('user-display').textContent = `Welcome, ${currentUser}`;
                }
            }
        }
     </script>
</body>
</html>
