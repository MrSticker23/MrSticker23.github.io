<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade Website</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #333;
            color: #fff;
            padding: 10px 20px;
            text-align: center;
        }
        .container {
            padding: 20px;
        }
        .chatroom {
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #fff;
            padding: 15px;
            margin-bottom: 20px;
        }
        .chat-display {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            padding: 10px;
            background: #f9f9f9;
        }
        .chat-input {
            display: flex;
            gap: 10px;
        }
        .chat-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .chat-input button {
            padding: 10px 15px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .chat-input button:hover {
            background-color: #555;
        }
        .auth-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #fff;
        }
        .auth-section input {
            display: block;
            margin: 10px 0;
            padding: 10px;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .auth-section button {
            padding: 10px 15px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
        }
        .auth-section button:hover {
            background-color: #555;
        }
        .moderation-panel {
            display: none;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #fff;
            padding: 15px;
            margin-bottom: 20px;
        }
        .moderation-panel input {
            margin: 10px 0;
            padding: 10px;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .moderation-panel button {
            padding: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .moderation-panel button:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <header>
        <h1>Trade Website</h1>
    </header>

    <div class="container">
        <!-- Authentication Section -->
        <div class="auth-section" id="authSection">
            <h2 id="authTitle">Sign Up</h2>
            <input type="text" id="authUsername" placeholder="Username">
            <input type="password" id="authPassword" placeholder="Password">
            <button onclick="handleAuth()" id="authButton">Sign Up</button>
            <p id="authToggleText">Already have an account? <a href="#" onclick="toggleAuthMode()">Log In</a></p>
        </div>

        <!-- Chatroom Section -->
        <div class="chatroom" id="chatroom" style="display: none;">
            <h2>Chatroom</h2>
            <div class="chat-display" id="chatDisplay"></div>
            <div class="chat-input">
                <input type="text" id="username" placeholder="Your Username" disabled>
                <input type="text" id="message" placeholder="Type a message">
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>

        <!-- Inventory Section -->
        <div class="inventory" id="inventory" style="display: none;">
            <h2>Your Inventory</h2>
            <ul id="inventoryList">
                <!-- Dynamically populated -->
            </ul>
        </div>

        <!-- Inbox Section -->
        <div class="inbox" id="inbox" style="display: none;">
            <h2>Trade Offers</h2>
            <ul id="tradeInbox">
                <!-- Dynamically populated -->
            </ul>
        </div>

        <!-- Moderation Panel -->
        <div class="moderation-panel" id="moderationPanel">
            <h2>Moderation Panel</h2>
            <input type="text" id="newItem" placeholder="Add New Item">
            <button onclick="addItem()">Add Item</button>
            <input type="text" id="targetUser" placeholder="Target Username">
            <input type="number" id="currencyAmount" placeholder="Currency Amount">
            <button onclick="addCurrency()">Add Currency</button>
        </div>
    </div>

    <script>
        let isLoggedIn = false;
        const users = {
            "owner": { password: "ownerpass", role: "owner", currency: 1000, inventory: [] },
            "admin1": { password: "adminpass1", role: "admin", currency: 500, inventory: [] },
            "admin2": { password: "adminpass2", role: "admin", currency: 500, inventory: [] },
            "admin3": { password: "adminpass3", role: "admin", currency: 500, inventory: [] },
        };
        const predefinedItems = ["Sword", "Shield", "Potion"];

        function handleAuth() {
            const username = document.getElementById('authUsername').value;
            const password = document.getElementById('authPassword').value;
            const authButton = document.getElementById('authButton');

            if (!username || !password) {
                alert('Please fill in both fields.');
                return;
            }

            if (authButton.textContent === 'Sign Up') {
                if (users[username]) {
                    alert('Username already exists.');
                } else {
                    users[username] = { password, role: "user", currency: 100, inventory: [] };
                    alert('Account created successfully! Please log in.');
                    toggleAuthMode();
                }
            } else {
                if (users[username] && users[username].password === password) {
                    alert('Login successful!');
                    isLoggedIn = true;
                    document.getElementById('username').value = username;
                    showMainContent(username);
                } else {
                    alert('Invalid username or password.');
                }
            }
        }

        function toggleAuthMode() {
            const authTitle = document.getElementById('authTitle');
            const authButton = document.getElementById('authButton');
            const authToggleText = document.getElementById('authToggleText');

            if (authButton.textContent === 'Sign Up') {
                authTitle.textContent = 'Log In';
                authButton.textContent = 'Log In';
                authToggleText.innerHTML = 'Don\'t have an account? <a href="#" onclick="toggleAuthMode()">Sign Up</a>';
            } else {
                authTitle.textContent = 'Sign Up';
                authButton.textContent = 'Sign Up';
                authToggleText.innerHTML = 'Already have an account? <a href="#" onclick="toggleAuthMode()">Log In</a>';
            }
        }

        function showMainContent(username) {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('chatroom').style.display = 'block';
            document.getElementById('inventory').style.display = 'block';
            document.getElementById('inbox').style.display = 'block';

            if (users[username].role === 'owner') {
                document.getElementById('moderationPanel').style.display = 'block';
            }

            loadInventory(username);
        }

        // Temporary memory for chat messages
        const chatMessages = [];

        function sendMessage() {
            const username = document.getElementById('username').value;
            const message = document.getElementById('message').value;

            if (username && message) {
                const fullMessage = `${username}: ${message}`;
                chatMessages.push(fullMessage);

                // Update chat display
                const chatDisplay = document.getElementById('chatDisplay');
                chatDisplay.innerHTML = chatMessages.map(msg => `<div>${msg}</div>`).join('');
                chatDisplay.scrollTop = chatDisplay.scrollHeight;

                // Clear input
                document.getElementById('message').value = '';
            } else {
                alert('Please enter both username and message.');
            }
        }

        function loadInventory(username) {
            const inventoryList = document.getElementById('inventoryList');
            inventoryList.innerHTML = users[username].inventory.map(item => `<li>${item}</li>`).join('');
        }

        function addItem() {
            const newItem = document.getElementById('newItem').value;
            if (newItem) {
                predefinedItems.push(newItem);
                alert(`${newItem} added to items.`);
                document.getElementById('newItem').value = '';
            } else {
                alert('Please enter an item name.');
            }
        }

        function addCurrency() {
            const targetUser = document.getElementById('targetUser').value;
            const currencyAmount = parseInt(document.getElementById('currencyAmount').value);

            if (users[targetUser] && !isNaN(currencyAmount)) {
                users[targetUser].currency += currencyAmount;
                alert(`${currencyAmount} currency added to ${targetUser}.`);
                document.getElementById('targetUser').value = '';
                document.getElementById('currencyAmount').value = '';
            } else {
                alert('Invalid username or amount.');
            }
        }

        // Initial predefined items
        function loadInitialItems() {
            console.log("Available items:", predefinedItems);
        }

        loadInitialItems();
    </script>
</body>
</html>
