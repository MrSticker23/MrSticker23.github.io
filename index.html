<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade Website</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #333;
            color: #fff;
            padding: 10px 20px;
            text-align: center;
            position: relative;
        }
        header .user-info {
            position: absolute;
            top: 10px;
            right: 20px;
            text-align: right;
        }
        header .user-info p {
            margin: 0;
            color: #fff;
        }
        .tabs {
            display: flex;
            background-color: #ddd;
            padding: 10px;
        }
        .tabs button {
            flex: 1;
            padding: 10px;
            border: none;
            background: #f4f4f4;
            cursor: pointer;
            font-size: 16px;
        }
        .tabs button.active {
            background: #333;
            color: #fff;
        }
        .container {
            padding: 20px;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .shop {
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #fff;
            padding: 15px;
            margin-bottom: 20px;
        }
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .shop-item button {
            padding: 5px 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .shop-item button:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <header>
        <h1>Trade Website</h1>
        <div class="user-info" id="userInfo"></div>
    </header>

    <div class="tabs">
        <button onclick="switchTab('auth')" class="active">Auth</button>
        <button onclick="switchTab('chatroom')">Chatroom</button>
        <button onclick="switchTab('inventory')">Inventory</button>
        <button onclick="switchTab('inbox')">Inbox</button>
        <button onclick="switchTab('shop')">Shop</button>
    </div>

    <div class="container">
        <!-- Authentication Section -->
        <div class="section auth active" id="auth">
            <h2 id="authTitle">Sign Up / Log In</h2>
            <input type="text" id="authUsername" placeholder="Username">
            <input type="password" id="authPassword" placeholder="Password">
            <button onclick="handleAuth()">Submit</button>
        </div>

        <!-- Chatroom Section -->
        <div class="section chatroom" id="chatroom">
            <h2>Chatroom</h2>
            <div class="chat-display" id="chatDisplay"></div>
            <div class="chat-input">
                <input type="text" id="username" placeholder="Your Username" disabled>
                <input type="text" id="message" placeholder="Type a message">
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>

        <!-- Inventory Section -->
        <div class="section inventory" id="inventory">
            <h2>Your Inventory</h2>
            <ul id="inventoryList"></ul>
        </div>

        <!-- Inbox Section -->
        <div class="section inbox" id="inbox">
            <h2>Trade Offers</h2>
            <ul id="tradeInbox"></ul>
        </div>

        <!-- Shop Section -->
        <div class="section shop" id="shop">
            <h2>Shop</h2>
            <div id="shopItems"></div>
        </div>

        <!-- Moderation Panel -->
        <div class="moderation-panel" id="moderationPanel" style="display: none;">
            <h2>Moderation Panel</h2>
            <h3>Users</h3>
            <ul id="userList"></ul>
            <input type="text" id="targetUser" placeholder="Target Username">
            <input type="number" id="currencyAmount" placeholder="Currency Amount">
            <button onclick="addCurrency()">Add Currency</button>
        </div>
    </div>

    <script>
        const users = JSON.parse(localStorage.getItem('users')) || {
            "owner": { password: "ownerpass", role: "owner", currency: 1000, inventory: [] }
        };
        const predefinedItems = [
            { name: "Owner's Chain", price: 500 },
            { name: "Dev Chain", price: 300 },
            { name: "Starter Chain", price: 100 }
        ];

        function handleAuth() {
            const username = document.getElementById('authUsername').value;
            const password = document.getElementById('authPassword').value;

            if (!username || !password) {
                alert('Please fill in both fields.');
                return;
            }

            if (users[username]) {
                if (users[username].password === password) {
                    alert('Login successful!');
                    localStorage.setItem('loggedInUser', username);
                    showMainContent(username);
                } else {
                    alert('Incorrect password.');
                }
            } else {
                users[username] = { password, role: "user", currency: 100, inventory: [] };
                localStorage.setItem('users', JSON.stringify(users));
                alert('Account created successfully!');
            }
        }

        function showMainContent(username) {
            document.getElementById('auth').style.display = 'none';
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.getElementById('chatroom').classList.add('active');

            if (users[username].role === 'owner') {
                document.getElementById('moderationPanel').style.display = 'block';
                loadUsers();
            }

            loadInventory(username);
            updateUserInfo(username);
            loadShop();
        }

        function switchTab(tabId) {
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.tabs button').forEach(button => button.classList.remove('active'));
            document.querySelector(`.tabs button[onclick="switchTab('${tabId}')"]`).classList.add('active');
        }

        function updateUserInfo(username) {
            const userInfo = document.getElementById('userInfo');
            userInfo.innerHTML = `<p>${username} (${users[username].role})</p><p>Balance: ${users[username].currency}</p>`;
        }

        function loadInventory(username) {
            const inventoryList = document.getElementById('inventoryList');
            inventoryList.innerHTML = users[username].inventory.map(item => `<li>${item}</li>`).join('');
        }

        function loadShop() {
            const shopItems = document.getElementById('shopItems');
            shopItems.innerHTML = predefinedItems.map(item => {
                return `<div class="shop-item">
                            <span>${item.name} - ${item.price} currency</span>
                            <button onclick="buyItem('${item.name}', ${item.price})">Buy</button>
                        </div>`;
            }).join('');
        }

        function buyItem(itemName, itemPrice) {
            const username = localStorage.getItem('loggedInUser');
            if (!username) return;

            const user = users[username];
            if (user.currency >= itemPrice) {
                user.currency -= itemPrice;
                user.inventory.push(itemName);
                alert(`You bought ${itemName}!`);
                localStorage.setItem('users', JSON.stringify(users));
                loadInventory(username);
                updateUserInfo(username);
            } else {
                alert('Not enough currency!');
            }
        }

        function loadUsers() {
            const userList = document.getElementById('userList');
            userList.innerHTML = Object.keys(users).map(user => `<li>${user} (${users[user].role})</li>`).join('');
        }

        function addCurrency() {
            const targetUser = document.getElementById('targetUser').value;
            const currencyAmount = parseInt(document.getElementById('currencyAmount').value);

            if (users[targetUser] && !isNaN(currencyAmount)) {
                users[targetUser].currency += currencyAmount;
                localStorage.setItem('users', JSON.stringify(users));
                alert(`${currencyAmount} currency added to ${targetUser}.`);
                updateUserInfo(targetUser);
            } else {
                alert('Invalid username or amount.');
            }
        }
    </script>
</body>
</html>
